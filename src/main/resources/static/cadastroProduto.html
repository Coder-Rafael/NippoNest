<body>

    <h1>Cadastro de Produto</h1>

    <form id="product-form" enctype="multipart/form-data">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required><br><br>

        <label for="descricao">Descrição:</label>
        <textarea id="descricao" name="descricao" required></textarea><br><br>

        <label for="preco">Preço:</label>
        <input type="number" step="0.01" id="preco" name="preco" required><br><br>

        <label for="estoque">Estoque:</label>
        <input type="number" id="estoque" name="estoque" required><br><br>

        <label for="genero">Gênero:</label>
        <input type="text" id="genero" name="genero" required><br><br>

        <label for="tipoProduto">Tipo de Produto:</label>
        <input type="text" id="tipoProduto" name="tipoProduto" required><br><br>

        <label for="imagens">Imagens:</label>
        <input type="file" id="imagens" name="imagens" multiple required><br><br>

        <button type="submit">Cadastrar Produto</button>
    </form>

    <script>
document.getElementById("product-form").addEventListener("submit", function(event) {
    event.preventDefault();

    const formData = new FormData();

    // Dados do produto
    const productData = {
        nome: document.getElementById("nome").value,
        descricao: document.getElementById("descricao").value,
        preco: parseFloat(document.getElementById("preco").value),
        estoque: parseInt(document.getElementById("estoque").value),
        genero: document.getElementById("genero").value,
        tipoProduto: document.getElementById("tipoProduto").value
    };

    // Adiciona o objeto product como JSON dentro de um Blob
    formData.append("product", new Blob([JSON.stringify(productData)], { type: "application/json" }));

    // Adiciona as imagens
    const imagens = document.getElementById("imagens").files;
    for (let i = 0; i < imagens.length; i++) {
        formData.append("imagens", imagens[i]);
    }

    let token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJuaXBwb25lc3QiLCJzdWIiOiIyNTBjNjBjYy02ZTUzLTQxZjQtYjM5Yy1mYzdhZDIzNWFiN2QiLCJleHAiOjE3Mzg1NDM3OTV9.RjYZxTtFX_YTHvEr-8vVeOv_ySq0AxXL6Ii5yZwv1BI"; // Substitua pelo token válido

    // Envia a requisição
    fetch("/api/products", {
        method: "POST",
        headers: {
            "Authorization": "Bearer " + token // Apenas o token, sem "Content-Type"
        },
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error("Erro ao cadastrar o produto.");
        }
        return response.json();
    })
    .then(data => {
        console.log("Produto cadastrado:", data);
        alert("Produto cadastrado com sucesso!");
    })
    .catch(error => {
        console.error("Erro:", error);
        alert("Erro ao cadastrar o produto.");
    });
});
    </script>

</body>